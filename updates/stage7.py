# –ü–†–û–ì–†–ê–ú–ú–ê: –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π
# –í–ï–†–°–ò–Ø: 1.0
# –ê–í–¢–û–†: werkzn
# –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ß—Ç–µ–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

FILE_NAME = "payments.txt"

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
    print("="*60)
    print("–ü–†–û–°–ú–û–¢–† –ò–°–¢–û–†–ò–ò –ü–õ–ê–¢–ï–ñ–ï–ô")
    print("="*60)
    
    try:
        # –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
        with open(FILE_NAME, "r", encoding="utf-8") as file:
            lines = file.readlines()
            
            if not lines:
                print("\nüì≠ –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø—É—Å—Ç–∞")
                print("\n–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂–∏, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É —É—á–µ—Ç–∞")
                return
                
            # –í—ã–≤–æ–¥–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            print(f"\nüìä –ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π: {len(lines)}")
            print("-"*60)
            
            # –í—ã–≤–æ–¥–∏–º –≤—Å–µ –∑–∞–ø–∏—Å–∏
            total_all = 0
            for i, line in enumerate(lines, 1):
                line = line.strip()
                parts = line.split('|')
                
                if len(parts) == 4:
                    date, rent, util, total = parts
                    
                    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É (05.2024 -> –ú–∞–π 2024)
                    month_num, year = date.split('.')
                    month_names = {
                        "01": "–Ø–Ω–≤", "02": "–§–µ–≤", "03": "–ú–∞—Ä", "04": "–ê–ø—Ä",
                        "05": "–ú–∞–π", "06": "–ò—é–Ω", "07": "–ò—é–ª", "08": "–ê–≤–≥",
                        "09": "–°–µ–Ω", "10": "–û–∫—Ç", "11": "–ù–æ—è", "12": "–î–µ–∫"
                    }
                    month_name = month_names.get(month_num, month_num)
                    date_formatted = f"{month_name} {year}"
                    
                    print(f"{i:3}. {date_formatted:12} "
                          f"–ö–æ–º–º—É–Ω–∞–ª–∫–∞: {float(util):>8.2f} —Ä—É–±. | "
                          f"–ò—Ç–æ–≥–æ: {float(total):>10.2f} —Ä—É–±.")
                    
                    total_all += float(total)
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            print("-"*60)
            print(f"üí∞ –í—Å–µ–≥–æ –≤—ã–ø–ª–∞—á–µ–Ω–æ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è: {total_all:>25.2f} —Ä—É–±.")
            
            if len(lines) > 0:
                avg_total = total_all / len(lines)
                print(f"üìä –°—Ä–µ–¥–Ω–∏–π –ø–ª–∞—Ç–µ–∂ –≤ –º–µ—Å—è—Ü: {avg_total:>30.2f} —Ä—É–±.")
            
            print("="*60)
            
    except FileNotFoundError:
        print(f"\nüì≠ –§–∞–π–ª '{FILE_NAME}' –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("\n–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —É—á–µ—Ç, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É")
        print("–∏ –≤–Ω–µ—Å–∏—Ç–µ –ø–µ—Ä–≤—ã–π –ø–ª–∞—Ç–µ–∂")
    except Exception as e:
        print(f"\n‚ö† –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {e}")
    
    # –û–∂–∏–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
    input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
if __name__ == "__main__":
    main()